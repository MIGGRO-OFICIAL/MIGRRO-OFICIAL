// VERSÃƒO FINAL - Copie e cole TUDO de uma vez no console

(async () => {
  // Tentar acessar supabase jÃ¡ carregado na pÃ¡gina
  let supabaseClient;
  
  // MÃ©todo 1: Verificar se estÃ¡ no window
  if (window.supabase) {
    supabaseClient = window.supabase;
    console.log('âœ… Supabase encontrado no window');
  } 
  // MÃ©todo 2: Carregar via CDN
  else {
    console.log('â³ Carregando Supabase via CDN...');
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js';
    document.head.appendChild(script);
    
    await new Promise((resolve) => {
      script.onload = resolve;
    });
    
    const { createClient } = supabase;
    const supabaseUrl = 'https://gjphsheavnkdtmsrxmtl.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdqcGhzaGVhdm5rZHRtc3J4bXRsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQyODE1NzMsImV4cCI6MjA3OTg1NzU3M30.GH8_htMszSrylCd6rMXNXioZUKNE303T6QeTBrevAbs';
    supabaseClient = createClient(supabaseUrl, supabaseKey);
    console.log('âœ… Supabase criado via CDN');
  }
  
  // 1. Verificar autenticaÃ§Ã£o
  console.log('ðŸ” Verificando autenticaÃ§Ã£o...');
  const { data: { user }, error: authError } = await supabaseClient.auth.getUser();
  console.log('âœ… UsuÃ¡rio:', user ? user.email : 'NÃƒO AUTENTICADO');
  if (authError) console.log('âŒ Erro de autenticaÃ§Ã£o:', authError);
  
  // 2. Testar query de posts
  console.log('ðŸ” Testando query de posts...');
  const { data, error } = await supabaseClient
    .from('posts')
    .select('*')
    .eq('is_deleted', false)
    .limit(5);
  
  console.log('âœ… Posts encontrados:', data ? data.length : 0);
  console.log('âœ… Posts:', data);
  if (error) {
    console.log('âŒ Erro na query:', error);
    console.log('âŒ Mensagem:', error.message);
    console.log('âŒ Detalhes:', error.details);
  }
  
  // 3. Verificar requisiÃ§Ãµes
  const networkRequests = performance.getEntriesByType('resource')
    .filter(r => r.name.includes('supabase'));
  console.log('âœ… Network requests ao Supabase:', networkRequests.length);
  networkRequests.forEach(req => {
    console.log('  -', req.name, 'Status:', req.responseStatus || 'N/A');
  });
  
  console.log('âœ… DiagnÃ³stico completo!');
})();
